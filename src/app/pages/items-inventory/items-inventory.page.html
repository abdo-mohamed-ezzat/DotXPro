<ion-header [translucent]="true" class="ion-no-border page-header">
  <ion-toolbar>
    <ion-buttons slot="start" color="light">
      <ion-back-button color="light"  defaultHref="/home"></ion-back-button>
    </ion-buttons>
    <ion-buttons slot="end">
      <ion-menu-toggle auto-hide="false" side="end">
        <ion-button>
          <ion-icon name="menu" color="light"></ion-icon>
        </ion-button>
      </ion-menu-toggle>
    </ion-buttons>
    <ion-title class="ion-text-center header-title-align"
      >مخزون الأصناف</ion-title
    >
  </ion-toolbar>
</ion-header>

<ion-content>
  <div class="container">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 320">
      <path
        fill="#1d4188"
        fill-opacity="1"
        d="M0,256L60,218.7C120,181,240,107,360,85.3C480,64,600,96,720,138.7C840,181,960,235,1080,261.3C1200,288,1320,288,1380,288L1440,288L1440,0L1380,0C1320,0,1200,0,1080,0C960,0,840,0,720,0C600,0,480,0,360,0C240,0,120,0,60,0L0,0Z"
      ></path>
    </svg>
    <ion-grid class="content-grid">
      <ion-row>
        <ion-col>
          <ion-button id="open-modal">
            <ion-icon name="filter-outline"></ion-icon>
          </ion-button>
        </ion-col>
      </ion-row>
    </ion-grid>
    <app-virtual-scrolling-table
      [MAX_COUNT]="maxCount"
      (fetchMoreData)="onLoadMoreData()"
    ></app-virtual-scrolling-table>
  </div>
  <app-spinner *ngIf="loading"></app-spinner>
</ion-content>
<ion-modal
  #modal
  trigger="open-modal"
  [initialBreakpoint]="1"
  [breakpoints]="[0, 0.75, 1]"
>
  <ng-template>
    <ion-content>
      <form [formGroup]="filterForm" (ngSubmit)="applyFilter()">
        <div class="options-section">
          <h2>الاصناف</h2>
          <mat-form-field class="width">
            <input
              matInput
              placeholder="اسم الصنف"
              aria-label="اسم الصنف"
              [matAutocomplete]="auto"
              [formControl]="itemsCtrl"
              required
              (click)="$any($event.target).select()"
            />
            <mat-error *ngIf="itemsCtrl.invalid">
              اسم الصنف طلوب
            </mat-error>
            <mat-autocomplete
              #auto="matAutocomplete"
              (optionSelected)="setOneItemValueOption($event)"
            >
              <cdk-virtual-scroll-viewport itemSize="20" class="viewport">
                <mat-option value="كافة الاصناف">كافة الاصناف</mat-option>
                <mat-option
                  class="vscr-item"
                  *cdkVirtualFor="let item of filteredItems | async"
                  [value]="item.value"
                >
                  <span>{{ item.value}}</span>
                </mat-option>
              </cdk-virtual-scroll-viewport>
            </mat-autocomplete>
          </mat-form-field>
        </div>
        <div class="options-section">
          <h2>اسم المخزن</h2>
          <app-select-chips
            [selectOptions]="storeOptions"
            (selectedOption)="setInventoryName($event)"
            [allowedMultiClick]="true"
          ></app-select-chips>
        </div>
        <div class="options-section">
          <h2>الفترة</h2>
          <app-select-chips [selectOptions]="timeOptinos"></app-select-chips>
          <app-date-input (toDateEmit)="handleToDate($event)"></app-date-input>
        </div>
        <div class="options-section">
          <ion-toggle
            labelPlacement="start"
            toggle-alignment-baseline
            formControlName="isInTheStock"
            ><h2>إظهار الكمية الصفرية</h2></ion-toggle
          >
          <ion-toggle
            labelPlacement="start"
            toggle-alignment-baseline
            formControlName="isBeforeRelay"
            ><h2>قبل الترحيل</h2></ion-toggle
          >
        </div>
        <div class="submit-button-container">
          <ion-button
            color="primary"
            size="large"
            shape="round"
            type="submit"
            (click)="submit()"
            >تطبيق</ion-button
          >
        </div>
      </form>
    </ion-content>
  </ng-template>
</ion-modal>
